---
title: "OneHotEncoder Convert to Json Format"
date: 2020-02-19
permalink: /codes/
classes: wide
tags: python snippet
categories: python-snippet
---



ðŸ§ƒ **scikit-learnì˜ OneHotEncoder ê²°ê³¼ë¥¼ json ì²˜ë¦¬í•´ì„œ ë³´ì—¬ì£¼ëŠ” ë°©ë²•**


```python
>> import json
>> import numpy as np
>> from sklearn.preprocessing import OneHotEncoder

>> transformer = OneHotEncoder(handle_unknown='ignore', sparse=False)

# example of single feature
>> X = [
        "StreetParking:yt_lot_1",
        "StreetParking:yt_lot_2",
        "StreetParking:yt_lot_3",
        "StreetParking:yt_lot_1",
        "StreetParking:yt_lot_2"
        ]  
  
# np.array(X).reshape(-1,1)
# array([['StreetParking:yt_lot_1'],
#       ['StreetParking:yt_lot_2'],
#       ['StreetParking:yt_lot_3'],
#       ['StreetParking:yt_lot_1'],
#       ['StreetParking:yt_lot_2']])

>> changed_field = transformer.fit_transform(np.array(X).reshape(-1,1))
>> print(change_field)
array([[1., 0., 0.],
       [0., 1., 0.],
       [0., 0., 1.],
       [1., 0., 0.],
       [0., 1., 0.]])
```
ìœ„ ëª¨ìŠµê³¼ ê°™ì´ transform()ê²°ê³¼ëŠ” np.array í˜•íƒœ


```python
>> import decimal
>> def _float_to_str(float_type):
      converted_value = decimal.Context().create_decimal(repr(float_type))
      return format(converted_value, 'f')

# ë¦¬ìŠ¤íŠ¸ ë‚´ë¶€ ê°œë³„ ìš”ì†Œì˜ íƒ€ìž… ë³€í™˜
>> changed_field = list(list(map(_float_to_str, i)) for i in changed_field)
# ë‹¤ìŒê³¼ ê°™ìŒ.. >> list(list(map(str, i)) for i in get_X)
>> print(changed_field)

[['1.0', '0.0', '0.0'], 
 ['0.0', '1.0', '0.0'], 
 ['0.0', '0.0', '1.0'],
 ['1.0', '0.0', '0.0'], 
 ['0.0', '1.0', '0.0']]

# ë¦¬ìŠ¤íŠ¸ ë‚´ ê°œë³„ ì¸ë±ì‹±ì— ëŒ€í•œ str() ì²˜ë¦¬ 
>> list(map(lambda x: str(x), changed_field))

["['1.0', '0.0', '0.0']", 
 "['0.0', '1.0', '0.0']", 
 "['0.0', '0.0', '1.0']", 
 "['1.0', '0.0', '0.0']",
 "['0.0', '1.0', '0.0']"] 

# ê²°ê³¼ JSON ë³€í™˜
>> json_convert = dict(zip(range(0, len(changed_field_2) + 1), changed_field_2))
>> print(json_convert)

{0: "['1.0', '0.0', '0.0']", 
 1: "['0.0', '1.0', '0.0']",
 2: "['0.0', '0.0', '1.0']", 
 3: "['1.0', '0.0', '0.0']", 
 4: "['0.0', '1.0', '0.0']"}

>> json.dumps(json_convert)

'{"0": "[\'1.0\', \'0.0\', \'0.0\']", 
  "1": "[\'0.0\', \'1.0\', \'0.0\']", 
  "2": "[\'0.0\', \'0.0\', \'1.0\']", 
  "3": "[\'1.0\', \'0.0\', \'0.0\']", 
  "4": "[\'0.0\', \'1.0\', \'0.0\']"}'
```

ðŸ§Š **ë§Œì•½ transformer ê²°ê³¼ê°€ np.arrayê°€ ì•„ë‹Œ scipy.sparse.csr.csr_matrix ì¸ ê²½ìš°**

```python
>> transformer = OneHotEncoder(handle_unknown='ignore', sparse=True)
>> transformer.fit_transform(np.array(X).reshape(-1,1))

<5x3 sparse matrix of type '<class 'numpy.float64'>'
        with 5 stored elements in Compressed Sparse Row format>
        
>> transformer.fit_transform(np.array(X).reshape(-1,1)).toarray()
```     
        
>>
